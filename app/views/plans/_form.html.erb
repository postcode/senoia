<div class="row">
  <div class="large-12 columns pageTitle">
    <h1>Enter Plan Information</h1>
  </div>
  <%= render 'plan_state' %>
  <div class="large-7 columns plan_form">
    <%= simple_form_for [@plan] do |f| %>
      <% if @plan.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@plan.errors.count, "error") %> prohibited this department from being saved:</h2>
          <ul>
          <% @plan.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
          </ul>
        </div>
      <% end %>
      <div class="row">
        <div class="small-5 columns input_label">
          <%= f.label :name, class: "inline", label: "Event Name" %>
        </div>
        <div class="small-7 columns">
          <%= f.input :name, label: false %>  
        </div>
      </div>
      <div class="row">
        <div class="small-5 columns input_label">
          <%= f.label :event_type, class: "inline" %>
        </div>
        <div class="small-7 columns">
        <%= f.association :event_type,
                              collection: EventType.all,
                              label_method: :name,
                              value_method: :id,
                              include_blank: false,
                              label: false %>
        </div>
      </div>

      <div class="row">
        <div class="small-5 columns input_label">
          <%= f.label :permitter, class: "inline", label: "Permitting Agency" %>
        </div>
        <div class="small-7 columns">
        <%= f.association :permitter,
                            collection: Permitter.all,
                            label_method: :name,
                            value_method: :id,
                            include_blank: false,
                            label: false %>
        </div>
      </div>
      
      <%= f.input :alcohol %>
      <span class="plan-staff">
        <fieldset>
          <legend>EVENT PLAN CREATOR</legend>          
          <p><i class="fi-torso"></i> John Doe</p>
          <p><i class="fi-mail"></i> john@example.gov</p>
          <p><i class="fi-telephone"></i> (123) 456-7890</p>
        </fieldset>
        <fieldset>
          <legend>APPROVED EDITORS</legend>          
          <p><i class="fi-torso"></i> John Doe</p>
          <p><i class="fi-mail"></i> john@example.gov</p>
          <p><i class="fi-telephone"></i> (123) 456-7890</p>
        </fieldset>      
      </span>
      <%= f.simple_fields_for :operation_periods do |op| %>
      <div class="operational-period">
        <h2>OPERATIONAL PERIOD</h2><br>
        <div class="row">
          <div class="small-2 columns input_label">
          <%= f.label :start_date, class: "inline", label: "START" %>
          </div>
          <div class="small-3 columns">
            <%= op.input :start_date, label: false, placeholder: "Date" %>
          </div>
          <div class="small-3 columns end">
            <%= op.input :end_date, label: false, placeholder: "Time" %>
          </div>
        </div>
        <div class="row">
          <div class="small-2 columns input_label">
          <%= f.label :start_date, class: "inline", label: "END" %>
          </div>
          <div class="small-3 columns">
            <%= op.input :start_date, label: false, placeholder: "Date" %>
          </div>
          <div class="small-3 columns end">
            <%= op.input :end_date, label: false, placeholder: "Time" %>
          </div>
        </div>        
        <div class="row">
          <div class="small-4 columns input_label">
            <%= f.label :attendance, class: "inline" do %>
             Crowd Size <a href="#" class="comment" data-reveal-id="attendance-comment">&nbsp;&nbsp;<i class="fi-comment"></i></a>
            <% end %>
            <div id="attendance-comment" class="reveal-modal small" data-reveal>
              <a class="close-reveal-modal">&#215;</a>
              <h3>Add A Comment</h3>
              <div class="modal-body">
                <label>Enter your comment:</label>
                <%= text_area(:attendance_comment, :text, cols: 20, rows: 5) %>
              </div>
              <div class="modal-footer">
                <a href="#" class="button primary save-modal">Add Comment</a>
              </div>
            </div>
          </div>
          <div class="small-4 columns end">
            <%= op.input :attendance, label: false %>
          </div>
        </div>

        <fieldset>
          <legend>FIRST AID STATIONS</legend>
          <%= op.simple_fields_for :first_aid_stations do |first_aid| %>
            <table id="first_aid_table" class="asset_table">
              <thead>
                <th></th>
                <th>Location</th>
                <th>Lvl</th>
                <th>MDs</th>
                <th>RNs</th>
                <th>EMTs</th>
                <th>AEDs</th>
                <th>Provider</th>
              </thead>
              <tbody>
                <tr class="more">
                  <td>
                  </td>
                </tr>
              </tbody>
            </table>  
          <% end %>
          <a id="new_first_aid_station" href="#" data-reveal-id="new-first-aid-station" class="button primary tiny radius"><i class="fi-plus"></i> ADD FIRST AID STATION</a>
          <%= render 'new_first_aid_station', plan: @plan, operation_period: op %>
        </fieldset>
        <fieldset>
          <legend>MOBILE TEAMS</legend>
          <%= op.simple_fields_for :mobile_teams do |mobile| %>
            <table>
              <thead>
                <th>Location</th>
                <th>Lvl</th>
                <th>AEDs</th>
                <th>Provider</th>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <a id="new_mobile_team" href="#" data-reveal-id="new-mobile-team"><i class="fi-plus"></i></a>
                    <%= render 'new_mobile_team', plan: @plan, operation_period: op %>
                  </td>
                </tr>
              </tbody>
            </table>  
          <% end %>
        </fieldset>
        <fieldset>
          <legend>TRANSPORT</legend>
          <%= op.simple_fields_for :transports do |t| %>
            <table id="transport_table">
              <thead>
                <th>Location</th>
                <th>Lvl</th>
                <th>Provider</th>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <a id="new_transport" href="#" data-reveal-id="new-transport"><i class="fi-plus"></i></a>
                    <%= render 'new_transport', plan: @plan, operation_period: op %>
                  </td>
                </tr>
              </tbody>
            </table>  
          <% end %>
        </fieldset>
        <fieldset>
          <legend>DISPATCH</legend>
          <%= op.simple_fields_for :dispatchs do |d| %>
            <table id="dispatch_table">
              <thead>
                <th>Location</th>
                <th>Lvl</th>
                <th>Provider</th>
              </thead>
              <tbody>
                <tr>
                  <td>
                    <a id="new_dispatch" href="#" data-reveal-id="new-dispatch"><i class="fi-plus"></i></a>
                    <%= render 'new_dispatch', plan: @plan, operation_period: op %>
                  </td>
                </tr>
              </tbody>
            </table>  
          <% end %>
        </fieldset>
      </div>
      <fieldset>
        <legend>RESPONSABILITY</legend>
        <p>The medical group supervisor or the event coordinator must contact the dispatch supervisor at DEC to take responsibility for the event footprint at the beginning of each operational period and release responsibility for the footprint at the end of each operational period.</p>
        <a href="#" class="button tiny radius">ACCEPT</a>
      </fieldset>
      <fieldset>      
        <legend>CPR & 911</legend>
        <p>During the operational period of the event safety personnel will follow the existing communications plan and will contact 911 only if medical needs overwhelm the capabilities of dedicated contracted medical assets. All medical interventions are the responsibility of the dedicated/contracted medical staff.</p>
        <a href="#" class="button tiny radius">ACCEPT</a>
      </fieldset> 
      <fieldset>      
        <legend>COMMUNICATIONS</legend>
        <p>All event safety personnel will have a list of contact info and will be communicating as specified in the Medical Assets section<br> In case of emergency during the event, the event coordinator can be reached at all times at:</p>
        <label>
          <input type="text" placeholder="(123) 456-7890" />
        </label> 
        <a href="#" class="button tiny radius">ACCEPT</a>
      </fieldset>
      <fieldset>
        <legend>SUPPLEMENTARY DOCUMENTS</legend>
        <a href="#" class="button tiny radius"><i class="fi-plus"></i> UPLOAD</a>
      </fieldset> 
      <fieldset>
        <legend>POST EVENT TREATMENT REPORT CREATOR</legend>
        <p> 
        <label><i class="fi-torso"></i> Name
          <input type="text" placeholder="" />
        </label></p>
        <p> 
        <label><i class="fi-mail"></i> Email
          <input type="text" placeholder="" />
        </label></p>
        <p> 
        <label><i class="fi-telephone"></i> Phone
          <input type="text" placeholder="" />
        </label></p> 
      </fieldset>                              
        <% end %>
    </div>    
    <div class="large-12 columns text-center actions plan-action">
        <%= f.submit class: "button large radius" %>
        <a href="#" class="button large warning radius"><i class="fi-check"></i> SUBMIT PLAN</a>
    </div>

    <% end %> 
  
</div>